<html>
<body>
    <p>Start:<input type="number" id="start" value="0" />End:<input type="number" id="end" value="2" /></p>
    <p>Input:
        <input id="i" type="text" value="Hello"/>
        <button type="button" onclick="deleteInputSelection();">Delete</button>
    </p>
    <p>Textarea:
        <textarea id="t">Boy</textarea>
        <button type="button" onclick="deleteAreaSelection();">Delete</button>
    </p>
    <p>Content Editable:
        <span id="c" contenteditable="true">Hello, some <b>bold</b> and <i>italic and <b>bold</b></i> text</span>
        <button type="button" onclick="deleteContentEditableText();">Delete</button>
    </p>
<script>
    var startInput = document.getElementById("start");
    var endInput = document.getElementById("end");

    function getSelectionRange() {
        var start = parseInt(startInput.value || "0");
        var end = parseInt(endInput.value || "2");
        return [start, end];
    }

    function deleteInputSelection() {
        var range = getSelectionRange();
        var elem = document.getElementById("i");
        elem.focus();
        elem.setSelectionRange(range[0], range[1], "forward");
	deleteSelection(elem);
    }

    function deleteAreaSelection() {
        var range = getSelectionRange();
        var elem = document.getElementById("t");
        elem.focus();
        elem.setSelectionRange(range[0], range[1], "forward");
	deleteSelection(elem);
    }

    function deleteSelection(node) {
        var nsIEditor = Components.interfaces.nsIEditor;
	node.QueryInterface(Components.interfaces.nsIDOMNSEditableElement)
	node.editor.deleteSelection(nsIEditor.ePrevious, nsIEditor.eStrip);
    }

    function deleteContentEditableText() {
        var [startPos, endPos] = getSelectionRange();
        var elem = document.getElementById("c");
        var length = elem.textContent.length;
        if (startPos < 0) {
            startPos = 0;
        }
        if (endPos > length) {
            endPos = length;
        }
        if (startPos >= endPos) {
            return;
        }
        deleteRangeText(elem, startPos, endPos);
    }
    
    function deleteRangeText(node, start, end) {
        var treeWalker = document.createTreeWalker(
            node,
            NodeFilter.SHOW_TEXT,
            function(node) {
                return NodeFilter.FILTER_ACCEPT;
            },
            false
        );

        var range = document.createRange();

        var charCount = 0;

        // Find the start node and set the start position
        while (treeWalker.nextNode()) {
            var currentLength = treeWalker.currentNode.length;
            if (start >= charCount + currentLength) {
                charCount += currentLength;
            } else {
                range.setStart(treeWalker.currentNode, start - charCount);
                break;
            }
        }

        // Find the end node and set the end position
        do {
            var currentLength = treeWalker.currentNode.length;
            if (end > charCount + currentLength) {
                charCount += currentLength;
            } else {
                range.setEnd(treeWalker.currentNode, end - charCount);
                break;
            }
        } while (treeWalker.nextNode());

        range.deleteContents();
    }
</script>
</body>
</htm>
